services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: quran-memorizer
    ports:
      - "3002:3000"
    environment:
      # Connect to shared PostgreSQL via shared-infra-network
      DATABASE_URL: "postgresql://postgres:MadisTrader2026@shared-postgres:5432/quranmemorizer2"
      # Connect to shared Redis via shared-infra-network
      REDIS_URL: "redis://:MadisTrader2026@shared-redis:6379"
      # NextAuth
      NEXTAUTH_SECRET: "quran-memorizer-dev-secret-change-in-production"
      NEXTAUTH_URL: "http://localhost:3002"
      # Auth
      AUTH_TRUST_HOST: "true"
      # Node
      NODE_ENV: "production"
    networks:
      - shared-infra-network
    restart: unless-stopped

networks:
  shared-infra-network:
    external: true
    name: shared-infra-network
